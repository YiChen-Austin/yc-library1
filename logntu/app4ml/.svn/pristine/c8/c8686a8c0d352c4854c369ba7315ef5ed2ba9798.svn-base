<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ include file="../include/head.jsp"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>龙途在线充值</title>
<link rel="icon" href="<%=path%>/images/logo/ml_ico.ico"
	type="image/x-icon" />
<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
<link href="<%=path%>/css/pay.css" rel="stylesheet" />
<link href="<%=path%>/css/bootstrap.css" rel="stylesheet" />
<link href="<%=path%>/css/layer.css" rel="stylesheet" />
</head>
<body>
	<div class="header">
		<div class="w1100 header-div">
			<img src="<%=path%>/images/logo.png" class="fl"> <span
				class="fl"> | 充值中心 </span>
				<div class="fr header-zh">
					<a href="" class="header-a">您好，Jackson</a> | <a href="">退出</a>
				</div>
				<div class="tab-tit fl">
					<a href="<%=project%>/pay4nl" class="s active">龙途在线充值元宝</a> <a
						href="<%=project%>/pay4l" class="s ">龙币账户充值</a>
				</div>
				<div class="grzx fr">
					<a href="<%=project%>/main" class="s ">个人中心</a>
				</div>
		</div>
	</div>
	<div>
		<div class="w1100 pay-com">
			<div class="pay-comleft fl">
				<h1>龙途在线简介</h1>
				<span> 10元宝/1元 </span>
				<p>《龙途》是有漫浪游戏倾力打造，采用 Unity引擎开发的一款大型多人在线角 色扮演游戏（MMORPG)网络游戏。它延
					续了传奇系列的玩法与强PK特性，传承 了战法道的职业体系，保留了经典版本 的原汁原味，让玩家在激情中享受快感， 在热血中重温回忆。</p>
				<div class="pay-bd">
					<input name="checkbox" class="ty" type="checkbox" checked>我已阅读并同意
					
				</div>
			</div>
			<div class="pay-comright fl">
				<div class="pay-div">
					<div class="pay-bd">
						<span class="fl"> 充值账号：</span> <input type="text"
							placeholder="输入账号" name="zh" value="" id="payid"
							onchange="payID()" class="fl num" /> <label id="payidlab"
							class="lab"><i></i><span></span></label>
					</div>
					<div class="pay-bd">
						<span class="fl"> 充值账户：</span>
						<div id="select_zone">
						</div>
					</div>
					<div class="pay-bd jediv">
						<span class="fl"> 充值数量：</span> <label class="active z czje"
							value="1000" restnum="">1000</label> <label class="czje z"
							value="4000" restnum="4000">4000</label> <label class="czje z"
							value="5000" restnum="5000">5000</label> <input type="text"
							placeholder="其他元宝" value="" class="je czje num" />
						<p>金额10元，获得100龙币，至少100龙途币</p>
					</div>
					<div class="pay-bd zffs">
						<span class="fl"> 支付方式：</span> <label class="active" restnum="">支付宝</label>
						<label restnum="">微信</label> <label restnum="">银行卡</label>
					</div>
					<ul class="zffs-ul">
						<li class="zffs-li">
							<div class="pay-bd">
								<span class="fl"> 应付金款：</span>
								<div class="fl">
									<span class="form-amount">100</span>元
									<%-- <img src="<%=path%>/images/zfbewm.png">
										<div>
											<img src="<%=path%>/images/zfbzf.png">
										</div> --%>
								</div>
							</div>
							<div class="pay-bd">
								<a href="javascript:void(0);" class="ljzf" onclick="alipay()">立即支付</a>
							</div>
						</li>
						<li class="zffs-li">
							<div class="pay-bd">
								<span class="fl"></span>
								<div class="fl">
									<img src="<%=path%>/images/wxerm.png">
										<div>
											<img src="<%=path%>/images/wxzf.png">
										</div>
								</div>

							</div> <!--<div class="pay-bd">
                            <a href="" class="ljzf">立即支付</a>
                        </div>-->
						</li>
						<li class="zffs-li lex">
							<div class="pay-bd">
								<span class="fl"> 选择银行卡类型：</span> <label class="active"
									restnum="">储蓄卡</label>
								<!--<label  restnum="">信用卡</label>-->
							</div>
							<div class="pay-bd xzyh">
								<span class="fl"> 选择银行：</span>
								<div style="margin-left: 131px;">
									<label class="active gs" restnum=""><i></i>工商银行</label> <label
										class="jt" restnum=""><i></i>交通银行</label> <label class="zg"
										restnum=""><i></i>中国银行</label> <label class="gf" restnum=""><i></i>广发银行</label>
									<label class="zx" restnum=""><i></i>中信银行</label> <label
										class="gd" restnum=""><i></i>光大银行</label> <label class="pf"
										restnum=""><i></i>浦发银行</label>
								</div>
							</div>
							<div class="pay-bd">
								<span class="fl"> 应付金款：</span>
								<div class="fl">
									<span class="form-amount">100</span>元
								</div>
							</div>
							<div class="pay-bd">
								<a href="" class="ljzf">立即支付</a>
							</div>

						</li>
					</ul>
				</div>
			</div>
		</div>
	</div>
	<jsp:include page="../include/bottom.jsp" />
</body>
<script src="<%=path%>/js/jquery-1.9.1.min.js"></script>
<script src="<%=path%>/js/layer.js"></script>
<script src="<%=path%>/js/jquery.cxselect.js"></script>
<script>
	(function() {
		load_server_data('');
	})();
    //加载服务器数据
    function load_server_data(){
    	var serverId='',prClass='';
    	if($(this).attr("server_id")){
    		serverId=$(this).attr("server_id");
    		prClass=$(this).attr("pre_class");
    	}
    	//删除所有子元素
    	if(serverId){
        	$("#select_zone .s_"+serverId).each(function(i, item) {
         		$(item).remove();
            });
        	$(this).prevAll().each(function(i, item) {
        		$("#select_zone .s_"+$(item).attr("server_id")).each(function(i, xitem) {
             		$(xitem).remove();
                });
            });
        	$(this).nextAll().each(function(i, item) {
        		$("#select_zone .s_"+$(item).attr("server_id")).each(function(i, xitem) {
             		$(xitem).remove();
                });
            });
    	}
    	_data={"serverId":serverId};
    	$.ajax({
            url:'<%=project%>/pay/serverZone',
            data:_data,
            type:'post',
            dataType:'json',
            success:function(json){
               if(json){
            	   if(!serverId){
            		   serverId="00";
            	   }
            	   var isNext=false;
            	   var _html='';
            	   _html+='<div class="nice-select fl s_'+serverId+' '+prClass+'" id="u_'+serverId+'" name="nice-select">';
            	   _html+='<input type="text" value="请选择" readonly>';
            	   _html+='<ul>';
            	   $.each(json,function(i, item) {
            		   _html+='<li server_id="'+item.serverId+'" pre_class="'+prClass+' s_'+serverId+'" value="'+item.serverId+'" data-value='+i+'>'+item.serverName+'</li>';
            		   if(parseInt(item.subLayer)>0){
               			  isNext=true;
               		   }
           		   });
            	   _html+='</ul></div>';
          	       $("#select_zone").append(_html);
        	       selectVal();
            	   if(isNext){
            		   $("#u_"+serverId+" li").bind("click",load_server_data);
            	   }
               }
            }
        })
    }
  //下拉框
    function selectVal(){
    	$('[name="nice-select"]').click(function(e){
    	    $('[name="nice-select"]').find('ul').hide();
    	    $(this).find('ul').show();
    	    e.stopPropagation();
    	});
    	$('[name="nice-select"] li').hover(function(e){
    	    $(this).toggleClass('on');
    	    e.stopPropagation();
    	});
    	$('[name="nice-select"] li').click(function(e){
    	    var val = $(this).text();
    	    $(this).parents('[name="nice-select"]').find('input').val(val);
    	    $('[name="nice-select"] ul').hide();
    	    e.stopPropagation();
    	});
    	$(document).click(function(){
    	    $('[name="nice-select"] ul').hide();
    	});
    }
	var stb2 = $('.czje');
	stb2.click(function() {
		$(this).addClass('active').siblings().removeClass('active');
	});

	$('.zffs-li:gt(0)').hide();//隐藏大于0
	var stb3 = $('.zffs label');
	stb3.click(function() {
		$(this).addClass('active').siblings().removeClass('active');
		var stb_index3 = stb3.index(this);//index(this)获取对象参数 获取ct的第几个
		$('.zffs-li').eq(stb_index3).show()//如果ct的和li相等就显示
		.siblings().hide();//隐藏掉上一个执行
	});

	var stb4 = $('.lex label');
	stb4.click(function() {
		$(this).addClass('active').siblings().removeClass('active');
	});
	var stb5 = $('.xzyh label');
	stb5.click(function() {
		$(this).addClass('active').siblings().removeClass('active');
	});
	var stb6 = $('.jl label');
	stb6.click(function() {
		$(this).addClass('active').siblings().removeClass('active');
	});

	$('.bd:gt(0)').hide();//隐藏大于0
	var stb6 = $('.jl label');
	stb6.click(function() {
		$(this).addClass('active').siblings().removeClass('active');
		var stb_index3 = stb6.index(this);//index(this)获取对象参数 获取ct的第几个
		$('.bd').eq(stb_index3).show()//如果ct的和li相等就显示
		.siblings().hide();//隐藏掉上一个执行
	});

	$('.z').click(function() {
		$('.form-amount').html($(this).html() / 10)
	});
	$('.je').blur(function() {
		var jg = $(".je").val();
		if (jg != null) {
			$('.form-amount').html($('.je').val() / 10);
		}
	})
	function alipay() {
		window.open("http://www.baidu.com");
        layer.open({
            type: 1,
            skin: 'a-gg', //样式类名
            closeBtn: 1, //不显示关闭按钮
            shift: 2,
            title: '登陆支付宝支付',
            shadeClose: true, //开启遮罩关闭
            content: '<div>请您在新打开的支付宝页面完成支付，支付完成前请不要关闭该窗口</div><div><a href="">已完成支付</a><a href="">支付时遇见问题</a></div>'
        });
    }
	//判断账号是否存在
	function payID(){
		 $('#payidlab').css('display','none');
        var _data = {
        	"userName":$("#payid").val(),
        };
        $.ajax({
            url:'<%=project%>/pay/validUn',
			data : _data,
			type : 'post',
			dataType : 'json',
			success : function(msg) {
				if (msg.serviceCode == '0') {
					 $('#payidlab').css('display','none');
				} else {
					$('#payidlab').css('display', 'inline-block');
					$('#payidlab span').text('没有此账号，请注册！！！');
				}
			}
		})
	}
	//判断只能输入数字
	$('.num').keyup(function() {
		var tmptxt = $(this).val();
		$(this).val(tmptxt.replace(/\D|^0/g, ''));
	}).bind("paste", function() {
		var tmptxt = $(this).val();
		$(this).val(tmptxt.replace(/\D|^0/g, ''));
	}).css("ime-mode", "disabled");
	$('.je').change(function() {
		var number = $(this).val();
		if(number < 100){
			$('.je').val("100");
		}
	})
</script>
</html>

